<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Geometry Dash Lite — Email Login</title>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js"></script>
<style>
body {
  margin:0; overflow:hidden;
  background: linear-gradient(90deg,#0f0c29,#302b63,#24243e);
  display:flex; justify-content:center; align-items:center;
  height:100vh; font-family:Arial,sans-serif; color:white;
}
#login {
  text-align:center; background: rgba(0,0,0,0.6);
  padding:30px; border-radius:10px;
}
input {display:block;margin:10px auto;padding:8px;width:200px;border-radius:5px;border:none;}
button {padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-weight:bold;}
#game {display:none;width:800px;height:250px;background:#222;border:3px solid #555;border-radius:10px;position:relative;overflow:hidden;margin-top:20px;}
#player {width:30px;height:30px;background:yellow;position:absolute;bottom:0;left:50px;border-radius:5px;}
.obstacle {width:30px;height:50px;background:red;position:absolute;bottom:0;right:-40px;animation:move 3s linear forwards;}
@keyframes move {from{right:-40px;}to{right:820px;}}
#score{position:absolute;top:10px;left:10px;font-size:20px;font-weight:bold;}
#gameover{position:absolute;top:40%;left:50%;transform:translate(-50%,-50%);font-size:30px;font-weight:bold;display:none;color:#ff4444;}
</style>
</head>
<body>

<div id="login">
  <h1>Регистрация / Вход</h1>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Пароль">
  <button id="registerBtn">Зарегистрироваться</button>
  <button id="loginBtn">Войти</button>
  <div id="message"></div>
</div>

<div id="game">
  <div id="player"></div>
  <div id="score">Очки: 0</div>
  <div id="gameover">Игра окончена! Нажми Enter для рестарта</div>
</div>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyC8lcLregxdwR6GBSrkMqlWoZNdUuU3jdM",
  authDomain: "chat-ca735.firebaseapp.com",
  projectId: "chat-ca735",
  storageBucket: "chat-ca735.firebasestorage.app",
  messagingSenderId: "407446630782",
  appId: "1:407446630782:web:db7293a24c6e6445ebc32f"
};

const app = firebase.initializeApp(firebaseConfig);
const auth = firebase.getAuth ? firebase.getAuth(app) : firebase.auth();

const emailInput = document.getElementById("email");
const passwordInput = document.getElementById("password");
const registerBtn = document.getElementById("registerBtn");
const loginBtn = document.getElementById("loginBtn");
const messageDiv = document.getElementById("message");
const loginDiv = document.getElementById("login");
const gameDiv = document.getElementById("game");

// Регистрация
registerBtn.addEventListener("click", () => {
  const email = emailInput.value;
  const password = passwordInput.value;
  firebase.createUserWithEmailAndPassword ? 
    firebase.createUserWithEmailAndPassword(auth,email,password)
    .then(userCredential => {
      messageDiv.textContent = "Регистрация успешна!";
      loginDiv.style.display="none"; gameDiv.style.display="block";
      startGame();
    })
    .catch(error => messageDiv.textContent = error.message)
    :
    auth.createUserWithEmailAndPassword(email,password)
    .then(userCredential => {
      messageDiv.textContent = "Регистрация успешна!";
      loginDiv.style.display="none"; gameDiv.style.display="block";
      startGame();
    })
    .catch(error => messageDiv.textContent = error.message);
});

// Вход
loginBtn.addEventListener("click", () => {
  const email = emailInput.value;
  const password = passwordInput.value;
  firebase.signInWithEmailAndPassword ?
    firebase.signInWithEmailAndPassword(auth,email,password)
    .then(userCredential => {
      messageDiv.textContent = "Вход успешен!";
      loginDiv.style.display="none"; gameDiv.style.display="block";
      startGame();
    })
    .catch(error => messageDiv.textContent = error.message)
    :
    auth.signInWithEmailAndPassword(email,password)
    .then(userCredential => {
      messageDiv.textContent = "Вход успешен!";
      loginDiv.style.display="none"; gameDiv.style.display="block";
      startGame();
    })
    .catch(error => messageDiv.textContent = error.message);
});

// --- Игра ---
function startGame(){
const player=document.getElementById("player");
const scoreElement=document.getElementById("score");
const gameOverText=document.getElementById("gameover");
let jumping=false, alive=true, score=0;

function jump(){if(jumping||!alive)return; jumping=true; let pos=0; const up=setInterval(()=>{
if(pos>=100){clearInterval(up); const down=setInterval(()=>{if(pos<=0){clearInterval(down); jumping=false;} else {pos-=5; player.style.bottom=pos+"px";}},20);} else {pos+=5; player.style.bottom=pos+"px";}},20);}

function spawnObstacle(){if(!alive) return; const obstacle=document.createElement("div"); obstacle.classList.add("obstacle"); gameDiv.appendChild(obstacle);
const checkCollision=setInterval(()=>{const playerRect=player.getBoundingClientRect(); const obstacleRect=obstacle.getBoundingClientRect();
if(playerRect.right>obstacleRect.left && playerRect.left<obstacleRect.right && playerRect.bottom>obstacleRect.top){
alive=false; gameOverText.style.display="block"; clearInterval(checkCollision);
}},10);
obstacle.addEventListener("animationend",()=>{obstacle.remove(); if(alive){score++; scoreElement.textContent="Очки: "+score;}});
setTimeout(spawnObstacle, Math.random()*2000+1000);}

document.addEventListener("keydown",(e)=>{if(e.code==="Space"){jump();} if(e.code==="Enter" && !alive){location.reload();}});
spawnObstacle();
}
</script>
</body>
</html>